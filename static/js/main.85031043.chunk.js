(this.webpackJsonpdictionary=this.webpackJsonpdictionary||[]).push([[0],{133:function(e,t,n){e.exports={authFull:"Style_authFull__11haa",blockAuth:"Style_blockAuth__11LZX",profile:"Style_profile__3YvBD"}},271:function(e,t,n){e.exports={entityCard:"WordsPage_entityCard__1t-xY"}},274:function(e,t,n){e.exports={btnCreate:"TableEditWords_btnCreate__1I1nf"}},299:function(e,t,n){e.exports=n(491)},487:function(e,t,n){},490:function(e,t,n){},491:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(28),i=n.n(c),u=n(7),o=n(22),l=n(47),s=n(280),d=n(35),f=n(90),p=n(211),m=n(118),b=n(69),y=n(8),E=n.n(y),h=n(19),O=n(497),v=n(499),j=n(76),g=n(9),w=n(23),S={user:"\n      name\n      lastName\n      email\n      id\n      role\n  ",entity:"\n   id,\n    title,\n    irrverb {\n      form1EN,\n      form2EN,\n      form3EN,\n      ru\n    },\n    isNeededEdit,\n    isCreate,\n    words {\n      id,\n      en,\n      type,\n      disconnectTranslate {\n        id\n      }\n      translate {\n        ru,\n        id,\n        type\n      },\n    },\n    phrases {\n      id,\n      phrase,\n      ru\n    },\n    sentences {\n      id, \n      sentence,\n      ru\n    },\n    disconnectWords {\n      id\n    },\n    disconnectPhrases {\n      id\n    },\n    disconnectSentences {\n      id\n    }\n  "};function I(){var e=Object(o.a)(["\n      query getCountEntities {\n          getCountEntities\n      }\n  "]);return I=function(){return e},e}function x(){var e=Object(o.a)(["\n      query getWord($entityId: Int!) {\n          entity(where: {\n              id: $entityId\n          }) {\n              id,\n              words {\n                  id,\n                  en,\n                  type,\n                  disconnectEntities {\n                      id\n                  }\n                  translate {\n                      id,\n                      ru,\n                      type,\n                      disconnectWords {\n                          id\n                      }\n                  }\n              }\n          }\n      }\n  "]);return x=function(){return e},e}function T(){var e=Object(o.a)(["\n      query PartOfSpeech {\n          partOfSpeechDescs {\n              id,\n              type,\n              ru,\n              ua,\n              en\n          }\n      }\n  "]);return T=function(){return e},e}function k(){var e=Object(o.a)(["\n      query getEntitiesByWord($word: String!) {\n          getEntitiesByWord(word: $word) @client {\n              ","\n          }\n      }\n  "]);return k=function(){return e},e}function C(){var e=Object(o.a)(["\n      query getEntity($id: Int!) {\n          getEntity(id: $id) @client\n      }\n  "]);return C=function(){return e},e}function P(){var e=Object(o.a)(["\n      query getEntities($id: Int) {\n          entities(where: {userId: {equals: $id}, isCreate: {equals: true}}, orderBy: {updatedAt: desc}) {\n              ","\n          }\n      }\n  "]);return P=function(){return e},e}function N(){var e=Object(o.a)(["\n      query countTranslate {\n          aggregateTranslate{\n              count\n          }\n      }\n  "]);return N=function(){return e},e}function W(){var e=Object(o.a)(["\n      query countWords {\n          aggregateWord{\n              count\n          }\n      }\n  "]);return W=function(){return e},e}function A(){var e=Object(o.a)(["\n      query countEntity {\n          aggregateEntity{\n              count\n          }\n      }\n  "]);return A=function(){return e},e}function D(){var e=Object(o.a)(["\n      query users {\n          users {\n              ","\n          }\n      }\n  "]);return D=function(){return e},e}function U(){var e=Object(o.a)(["\n      {\n          isAuth @client\n      }\n  "]);return U=function(){return e},e}function $(){var e=Object(o.a)(["\n      mutation {\n          refreshUser {\n              ","\n          }\n      }\n  "]);return $=function(){return e},e}function R(){var e=Object(o.a)(["\n      {\n          step @client\n      }\n  "]);return R=function(){return e},e}function _(){var e=Object(o.a)(["\n      {\n          currentUser @client {\n              ","\n          }\n      }\n  "]);return _=function(){return e},e}function H(){var e=Object(o.a)(["\n      mutation signUp($data: UserSignUpInput!) {\n          signup(data: $data) {\n              user {\n                  ","\n              }\n              token\n          }\n      }\n  "]);return H=function(){return e},e}function F(){var e=Object(o.a)(["\n      mutation login($loginData: LoginUserInput!) {\n          login(data: $loginData) {\n              user {\n                  ","\n              }\n              token\n          }\n      }\n  "]);return F=function(){return e},e}var B,V={LOGIN:Object(w.a)(F(),S.user),SIGNUP:Object(w.a)(H(),S.user),CURRENT_USER:Object(w.a)(_(),S.user),GET_STEP_CLIENT:Object(w.a)(R()),REFRESH_USER:Object(w.a)($(),S.user),IS_AUTH:Object(w.a)(U()),USERS:Object(w.a)(D(),S.user),COUNT_ENTITY:Object(w.a)(A()),COUNT_WORDS:Object(w.a)(W()),COUNT_TRANSLATE:Object(w.a)(N()),GET_ENTITIES:Object(w.a)(P(),S.entity),getEntity:Object(w.a)(C()),GET_ENTITIES_BY_WORD_CLIENT:Object(w.a)(k(),S.entity),GET_PART_OF_SPEECH:Object(w.a)(T()),GET_WORD:Object(w.a)(x()),GET_COUNT_ENTITIES:Object(w.a)(I())},q={labelCol:{span:8},wrapperCol:{span:16}},z={wrapperCol:{offset:8,span:16}},L=function(){var e=Object(g.b)(V.LOGIN,{update:function(e,t){e.writeData({data:{isAuth:!0,currentUser:t.data.login.user}}),localStorage.setItem("token",t.data.login.token)}}),t=Object(u.a)(e,2),n=t[0],a=t[1],c=(a.data,a.error,function(){var e=Object(h.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({variables:{loginData:t}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return r.a.createElement(O.a,Object.assign({},q,{name:"basic",initialValues:{remember:!0},onFinish:c}),r.a.createElement(O.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(v.a,null)),r.a.createElement(O.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(v.a.Password,null)),r.a.createElement(O.a.Item,z,r.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Submit")))},G={labelCol:{span:8},wrapperCol:{span:16}},K={wrapperCol:{offset:8,span:16}},J=function(){var e=Object(g.b)(V.SIGNUP,{update:function(e,t){e.writeData({data:{isAuth:!0,currentUser:t.data.login.user}}),localStorage.setItem("token",t.data.login.token)}}),t=Object(u.a)(e,2),n=t[0],a=(t[1].data,function(){var e=Object(h.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({variables:{data:t}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return r.a.createElement(O.a,Object.assign({},G,{name:"basic",initialValues:{remember:!0},onFinish:a}),r.a.createElement(O.a.Item,{label:"Username",name:"name",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(v.a,null)),r.a.createElement(O.a.Item,{label:"Last name",name:"lastName",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(v.a,null)),r.a.createElement(O.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(v.a,null)),r.a.createElement(O.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(v.a.Password,null)),r.a.createElement(O.a.Item,{label:"Repeat password",name:"repeatPassword",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(v.a.Password,null)),r.a.createElement(O.a.Item,K,r.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Submit")))},M=n(133),Y=n.n(M),Q=function(e){return function(t){var n=Object(g.c)(V.IS_AUTH,{fetchPolicy:"cache-only",onError:function(e){}}).data,a="/main/words";return t.location.state&&t.location.state.from&&(a=t.location.state.from),n&&n.isAuth?r.a.createElement(d.a,{to:a}):r.a.createElement(e,t)}},X=p.a.TabPane,Z=Q((function(){return r.a.createElement(m.a,{justify:"center",align:"middle",className:Y.a.authFull},r.a.createElement(b.a,{span:6,className:Y.a.blockAuth},r.a.createElement(p.a,{defaultActiveKey:"1",animated:{inkBar:!0,tabPane:!1}},r.a.createElement(X,{tab:"Login",key:"1"},r.a.createElement(L,null)),r.a.createElement(X,{tab:"Sign up",key:"2",disabled:!0},r.a.createElement(J,null)))))})),ee=n(494),te=n(97),ne=n(516),ae=n(517),re=n(518),ce=n(519),ie=function(e){return function(t){var n=Object(g.c)(V.IS_AUTH,{fetchPolicy:"cache-only"}).data;return n&&n.isAuth?r.a.createElement(e,t):r.a.createElement(d.a,{to:{pathname:"/",state:{from:t.location.pathname}}})}};!function(e){e.ADMIN="ADMIN",e.STANDARD="STANDARD"}(B||(B={}));var ue,oe=function(){var e=Object(g.c)(V.CURRENT_USER,{onError:function(e){}}).data,t=null,n=!1;return e&&e.currentUser&&(n=(t=e.currentUser).role===B.ADMIN),{user:t,isAdmin:n}},le=n(504),se=n(500),de=n(495),fe=function(){var e=Object(g.c)(V.GET_PART_OF_SPEECH,{fetchPolicy:"cache-first"}).data;return e?e.partOfSpeechDescs:[]},pe=[{title:"Id",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Last name",dataIndex:"lastName",key:"lastName"},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",key:"role",dataIndex:"role",render:function(e){var t=e===B.ADMIN?"geekblue":"green";return r.a.createElement(le.a,{color:t,key:e},e.toUpperCase())}}],me=function e(t,n){for(var a=0,r=Object.keys(t);a<r.length;a++){var c=r[a];if(c===n)return t[c];if("object"===typeof t[c]){var i=e(t[c],n);if(i)return i}}},be=function(){fe();var e=Object(g.c)(V.USERS,{}).data,t=Object(g.c)(V.COUNT_TRANSLATE,{returnPartialData:!0}).data,n=Object(g.c)(V.COUNT_WORDS,{returnPartialData:!0}).data,a=Object(g.c)(V.COUNT_ENTITY,{returnPartialData:!0}).data,c=e?e.users:[],i=me(t,"count"),u=me(n,"count"),o=me(a,"count");return r.a.createElement(m.a,null,r.a.createElement(b.a,{span:24},r.a.createElement(se.a,{title:"Vocabulary Info"},o&&r.a.createElement(se.a.Item,{label:"Entity"},o),u&&r.a.createElement(se.a.Item,{label:"Words"},u),i&&r.a.createElement(se.a.Item,{label:"Translate"},i))),r.a.createElement(b.a,{span:24},r.a.createElement(de.a,{columns:pe,dataSource:c})))},ye=n(503);!function(e){e.ADJ="ADJ",e.ADV="ADV",e.CONJ="CONJ",e.DET="DET",e.MODAL="MODAL",e.NOUN="NOUN",e.PREP="PREP",e.PRON="PRON",e.VERB="VERB",e.OTHER="OTHER"}(ue||(ue={}));var Ee=function(e){var t=e.type,n=he(t);if("object"===typeof n){var a=Oe(n.type);return r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{color:a},n.en.toUpperCase()),r.a.createElement(le.a,{color:a},n.ua.toUpperCase()),r.a.createElement(le.a,{color:a},n.ru.toUpperCase()))}return r.a.createElement(le.a,{color:Oe(t)},t.toUpperCase())},he=function(e){var t=fe().find((function(t){return t.type===e}));return null===t?e:t},Oe=function(e){switch(e){case ue.ADJ:return"magenta";case ue.ADV:return"gold";case ue.OTHER:return"default";case ue.VERB:return"geekblue";case ue.NOUN:return"green";case ue.CONJ:return"lime";case ue.MODAL:return"blue";case ue.DET:return"default";case ue.PREP:return"cyan";case ue.PRON:return"purple"}return"default"},ve=de.a.Column,je=function(e){var t=e.word;return t.translate=t.translate.filter((function(e){return!t.disconnectTranslate.some((function(t){return t.id===e.id}))})),r.a.createElement(de.a,{dataSource:t.translate,pagination:!1,size:"small",showHeader:!1},r.a.createElement(ve,{title:"RU",dataIndex:"ru",key:"ru",width:"50%"}),r.a.createElement(ve,{width:"50%",title:"Part of speech",dataIndex:"type",key:"type",render:function(e){return r.a.createElement(Ee,{type:e})}}))},ge=n(143),we=n(496),Se=de.a.Column,Ie=we.a.Text,xe=function(e){var t=e.dataIndex,n=e.record,a=e.children,c=Object(ge.a)(e,["dataIndex","record","children"]);return"en"===t&&void 0===n.children||"ru"===t&&n.children?null:r.a.createElement("td",c,"en"===t?r.a.createElement(Ie,{strong:!0},a):r.a.createElement(Ie,{type:"secondary"},a))},Te=function(e){var t=e.words,n=e.disconnectWords,a=t.filter((function(e){return!n.some((function(t){return t.id===e.id}))})).map((function(e,t){return{key:e.id,en:e.en,type:e.type,children:e.translate}}));return r.a.createElement(de.a,{dataSource:a,pagination:!1,size:"small",showHeader:!1,components:{body:{cell:xe}}},r.a.createElement(Se,{title:"EN",dataIndex:"en",key:"en",width:"40%",onCell:function(e){return{record:e,dataIndex:"en",title:"EN"}}}),r.a.createElement(Se,{title:"RU",dataIndex:"ru",key:"ru",onCell:function(e){return{record:e,dataIndex:"ru",title:"RU"}}}),r.a.createElement(Se,{width:"60%",title:"Part of speech",dataIndex:"type",key:"type",render:function(e){return r.a.createElement(Ee,{type:e})}}))},ke=we.a.Text,Ce=function(e){var t=e.phrases,n=e.disconnectPhrases,a=t.filter((function(e){return!n.some((function(t){return t.id===e.id}))}));return r.a.createElement(m.a,null,a.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{span:12},r.a.createElement(ke,{strong:!0},e.phrase),r.a.createElement("br",null),r.a.createElement(ke,{type:"secondary"},e.ru)))})))},Pe=we.a.Text,Ne=function(e){var t=e.sentences,n=e.disconnectSentences,a=t.filter((function(e){return!n.some((function(t){return t.id===e.id}))}));return r.a.createElement(m.a,null,a.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{span:24},r.a.createElement(Pe,{strong:!0},e.sentence),r.a.createElement("br",null),r.a.createElement(Pe,{type:"secondary"},e.ru)))})))},We=n(271),Ae=n.n(We),De=[{key:"translate",tab:"Translate",component:je},{key:"words",tab:"Words",component:Te},{key:"phrases",tab:"Phrases",component:Ce},{key:"sentences",tab:"Sentences",component:Ne}],Ue=function(e){var t=e.entity,n=Object(a.useState)("translate"),c=Object(u.a)(n,2),i=c[0],o=c[1],l=t.words.find((function(e){return e.en===t.title})),s=t.words.filter((function(e){return e.en!==t.title})),d=De.find((function(e){return e.key===i})).component;return r.a.createElement(ye.a.Grid,{className:Ae.a.entityCard},r.a.createElement(ye.a,{tabList:De,activeTabKey:i,onTabChange:function(e){o(e)},type:"inner",title:t.title,extra:r.a.createElement(f.b,{to:{pathname:"/main/create/",state:{id:t.id}}},"Edit")},r.a.createElement(d,{word:l,sentences:t.sentences,disconnectWords:t.disconnectWords,words:s,phrases:t.phrases,disconnectSentences:t.disconnectSentences,disconnectPhrases:t.disconnectPhrases})))},$e=function(){fe();var e=oe().user,t=Object(g.c)(V.GET_ENTITIES,{variables:{id:e.id}}).data,n=t?t.entities:[];return r.a.createElement(m.a,null,r.a.createElement(b.a,{span:24},r.a.createElement(ye.a,{title:"Vocabulary",size:"small"},n.map((function(e){return r.a.createElement(Ue,{key:e.id,entity:e})})))))},Re=n(501),_e=function(){return r.a.createElement(Re.a,{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist.",extra:r.a.createElement(f.b,{to:"/main/words",component:j.a,type:"primary"},"Back Home")})},He=n(273),Fe=n(502),Be=n(498),Ve=n(39),qe=function(e){return 0===Object.keys(e).length},ze=n(142),Le=ze.a.Option;function Ge(e){var t=e.label;return r.a.createElement(Ee,{type:t})}var Ke=function(e){var t=fe();return r.a.createElement(ze.a,Object.assign({tagRender:Ge,bordered:!1,suffixIcon:null},e),t.map((function(e){return r.a.createElement(Le,{value:e.type,key:e.type},r.a.createElement(Ee,{type:e.type}))})))},Je=n(505),Me=n(506);function Ye(){var e=Object(o.a)(["\n      mutation translateWord($word: String!, $entity: String!) {\n          translateWord(word: $word, entity: $entity) {\n              type,\n              translate {\n                  type,\n                  ru\n              }\n          }\n      }\n  "]);return Ye=function(){return e},e}function Qe(){var e=Object(o.a)(["\n      mutation getEntitiesByWord($word: String!) {\n          getEntitiesByWord(word: $word) {\n              ","\n          }\n      }\n  "]);return Qe=function(){return e},e}function Xe(){var e=Object(o.a)(["\n      mutation updateSentencesByEntity($data: UpdateSentencesInput!) {\n          updateSentencesByEntity(data: $data)\n      }\n  "]);return Xe=function(){return e},e}function Ze(){var e=Object(o.a)(["\n      mutation updatePhraseByEntity($data: UpdatePhrasesInput!) {\n          updatePhraseByEntity(data: $data)\n      }\n  "]);return Ze=function(){return e},e}function et(){var e=Object(o.a)(["\n      mutation upsertSentence($sentence: String!, $ru: String!, $entityId: Int!) {\n          upsertSentence(where: {\n              sentence: $sentence\n          }, create: {\n              sentence: $sentence,\n              ru: $ru,\n              entities: {\n                  connect: {\n                      id: $entityId\n                  }\n              }\n          }, update: {\n              entities: {\n                  connect: {\n                      id: $entityId\n                  }\n              }\n          }) {\n              id,\n              sentence,\n              ru\n          }\n      }\n  "]);return et=function(){return e},e}function tt(){var e=Object(o.a)(["\n      mutation upsertPhrase($phrase: String!, $ru: String!, $entityId: Int!) {\n          upsertPhrase(where: {\n              phrase: $phrase\n          }, create: {\n              phrase: $phrase,\n              ru: $ru,\n              entities: {\n                  connect: {\n                      id: $entityId\n                  }\n              }\n          }, update: {\n              entities: {\n                  connect: {\n                      id: $entityId\n                  }\n              }\n          }) {\n              id,\n              phrase,\n              ru\n          }\n      }\n  "]);return tt=function(){return e},e}function nt(){var e=Object(o.a)(["\n      mutation translateSentence($sentence: String!, $entity: String!) {\n          translateSentence(sentence: $sentence, entity: $entity) {\n              sentence,\n              ru\n          }\n      }\n  "]);return nt=function(){return e},e}function at(){var e=Object(o.a)(["\n      mutation translatePhrase($phrase: String!, $entity: String!) {\n          translatePhrase(phrase: $phrase, entity: $entity) {\n              phrase,\n              ru\n          }\n      }\n  "]);return at=function(){return e},e}function rt(){var e=Object(o.a)(["\n      mutation upsertTranslate($idWord: Int!, $ru: String!) {\n          upsertTranslate(where: {\n              ru: $ru\n          }, create: {\n              ru: $ru,\n              type: OTHER,\n              words: {\n                  connect: {\n                      id: $idWord\n                  }\n              }\n          },\n              update: {\n                  words: {\n                      connect: {\n                          id: $idWord\n                      }\n                  }\n              }) {\n              id,\n              ru,\n              type,\n          }\n      }\n  "]);return rt=function(){return e},e}function ct(){var e=Object(o.a)(["\n      mutation updateWordsByEntity($data: TranslateWordWithParseInput!) {\n          updateWordsByEntity(data: $data)\n      }\n  "]);return ct=function(){return e},e}function it(){var e=Object(o.a)(["\n      mutation createOrUpdateWordWithTranslate($entityId: Float!,$type: PartOfSpeech!, $en: String!, $translate: [String!]!) {\n          createOrUpdateWordWithTranslate(entityId: $entityId, type: $type, en: $en, translate: $translate) {\n              id,\n              en,\n              type,\n              disconnectTranslate {\n                  id\n              },\n              translate {\n                  id,\n                  ru,\n                  type\n              }\n          }\n      }\n  "]);return it=function(){return e},e}function ut(){var e=Object(o.a)(["\n      mutation deleteTranslate($idTransalte: Int!, $idWord: Int!) {\n          updateWord(data: {\n              disconnectTranslate: {\n                  connect: {\n                      id: $idTransalte\n                  }\n              }\n          }, where: {\n              id: $idWord\n          }) {\n              id,\n              disconnectTranslate {\n                  id\n              }\n          }\n      }\n  "]);return ut=function(){return e},e}function ot(){var e=Object(o.a)(["\n      mutation deleteWord($idEntity: Int!, $idWord: Int!) {\n          updateWord(data: {\n              disconnectEntities: {\n                  connect: {\n                      id: $idEntity\n                  }\n              }\n          }, where: {id: $idWord}) {\n              id\n          }\n      }\n  "]);return ot=function(){return e},e}var lt={deleteWord:Object(w.a)(ot()),deleteTranslate:Object(w.a)(ut()),createOrUpdateWordWithTranslate:Object(w.a)(it()),updateWordsByEntity:Object(w.a)(ct()),upsertTranslate:Object(w.a)(rt()),translatePhrase:Object(w.a)(at()),translateSentence:Object(w.a)(nt()),upsertPhrase:Object(w.a)(tt()),upsertSentence:Object(w.a)(et()),updatePhraseByEntity:Object(w.a)(Ze()),updateSentencesByEntity:Object(w.a)(Xe()),GET_ENTITIES_BY_WORD:Object(w.a)(Qe(),S.entity),TRANSLATE_WORD:Object(w.a)(Ye())},st=n(274),dt=n.n(st),ft=v.a.Search,pt=function(e){var t=e.onClose,n=e.idWord,a=e.onAdd,c=Object(g.b)(lt.upsertTranslate),i=Object(u.a)(c,2),o=i[0],l=i[1].loading,s=function(){var e=Object(h.a)(E.a.mark((function e(r){var c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,o({variables:{idWord:n,ru:r}});case 4:c=e.sent,i=c.data.upsertTranslate,a(n,i),t();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(ft,{placeholder:"input search text",onSearch:s,allowClear:!0,enterButton:!0,loading:l})},mt=function(e){var t=e.idWord,n=e.onAdd,c=Object(a.useState)(!1),i=Object(u.a)(c,2),o=i[0],l=i[1];return r.a.createElement(Je.a,{content:r.a.createElement(pt,{onClose:function(){l(!1)},idWord:t,onAdd:n}),trigger:"click",visible:o,onVisibleChange:function(e){l(e)},placement:"rightBottom"},r.a.createElement(j.a,{size:"middle",shape:"circle",className:dt.a.btnCreate,onClick:function(){return l(!0)},icon:r.a.createElement(Me.a,null)}))},bt=n(156),yt=n(80),Et=function(e,t){var n=e;return Object.keys(t).forEach((function(e){t[e]&&(n=n+" "+e)})),n},ht=n(507),Ot=(n(487),r.a.createContext(null)),vt=function(e){e.index;var t=Object(ge.a)(e,["index"]),n=O.a.useForm(),a=Object(u.a)(n,1)[0];return r.a.createElement(O.a,{form:a,component:!1},r.a.createElement(Ot.Provider,{value:a},r.a.createElement("tr",t)))},jt=function(e){var t=e.title,n=e.editable,c=e.extra,i=e.children,o=e.dataIndex,s=e.record,d=e.handleSave,f=e.handleTranslate,p=Object(ge.a)(e,["title","editable","extra","children","dataIndex","record","handleSave","handleTranslate"]),m=Object(a.useState)(!1),b=Object(u.a)(m,2),y=b[0],g=b[1],w=Object(a.useRef)(),S=Object(a.useContext)(Ot);Object(a.useEffect)((function(){y&&w.current.focus()}),[y]);var I=function(){g(!y),S.setFieldsValue(Object(bt.a)({},o,s[o]))},x=function(){var e=Object(h.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.validateFields();case 3:n=e.sent,I(),d(Object(l.a)({},s,{},n,{dataIndex:o})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Save failed:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),T=i;return n&&(T=y?r.a.createElement(O.a.Item,{style:{margin:0},name:o,rules:[{required:!0,message:"".concat(t," is required.")}]},r.a.createElement(v.a,{ref:w,onPressEnter:x,onBlur:x,className:Et("editable-cell-value-wrap",{"cell-ru":"ru"===o})})):r.a.createElement("div",{className:Et("editable-cell-value-wrap",{"cell-ru":"ru"===o}),onClick:I},i,c&&s.isNeededTranslate&&r.a.createElement(yt.a,{title:"Translate"},r.a.createElement(j.a,{onClick:function(){return f(Object(l.a)({},s))},className:"btnTranslate",shape:"round",size:"small",icon:r.a.createElement(ht.a,null)})))),"en"===o&&void 0===s.children||"ru"===o&&s.children?null:r.a.createElement("td",p,T)},gt=n(509),wt=n(510),St=n(275),It=function e(){var t=this;Object(St.a)(this,e),this.history=null,this.current=null,this.handlers=[],this.addHandler=function(e){t.handlers.push(e)},this.getRevertAction=function(e){var n=t.handlers.find((function(t){return Object.keys(t).some((function(t){return t===e}))}));return n[Object.keys(n).filter((function(t){return t!==e}))[0]]},this.getAction=function(e){return t.handlers.find((function(t){return Object.keys(t).some((function(t){return t===e}))}))[e]},this.addAction=function(e){t.history=t.current;var n=Object(l.a)({nextAction:null,prevAction:t.history},e);t.history.nextAction=n,t.history=n,t.current=t.history},this.prev=function(){null!==t.current&&null!==t.current.prevAction&&(t.getRevertAction(t.current.action)(t.current.payload),t.current=t.current.prevAction)},this.next=function(){null!==t.current&&null!==t.current.nextAction&&(t.current=t.current.nextAction,t.getAction(t.current.action)(t.current.payload))},this.isPrev=function(){return null!==t.current&&null!==t.current.prevAction},this.isNext=function(){return null!==t.current&&null!==t.current.nextAction},this.current=this.history={prevAction:null,payload:"",action:"",nextAction:null}},xt=n(172),Tt=n(508),kt=function(e){var t=e.disabled,n=e.onUpdate,c=e.onAdd,i=e.loadingUpdate,o=e.entity,l=e.isCreate,s=e.disabledNext,d=e.onNext,f=e.disabledPrev,p=e.onPrev,b=e.onChangeShowDeleted,y=e.addComponent,E=e.btnTitle,h=Object(a.useState)(!1),O=Object(u.a)(h,2),v=O[0],g=O[1];return r.a.createElement(m.a,{justify:"space-between"},r.a.createElement("div",null,r.a.createElement(j.a,{size:"small",type:"link",onClick:p,disabled:f,icon:r.a.createElement(Tt.a,null)}),r.a.createElement(j.a,{size:"small",type:"link",onClick:d,disabled:s,icon:r.a.createElement(gt.a,null)}),r.a.createElement(xt.default.Group,{onChange:function(e){return b(e.target.value)},defaultValue:0,buttonStyle:"solid",size:"small"},r.a.createElement(xt.default.Button,{value:1},"Show"),r.a.createElement(xt.default.Button,{value:0},"Hide"))),r.a.createElement(j.a.Group,null,r.a.createElement(j.a,{onClick:n,type:"primary",disabled:t||i,loading:i},l?"Update":"Create"),r.a.createElement(Je.a,{content:r.a.createElement(y,{onClose:function(){g(!1)},onAdd:c,entity:o}),trigger:"click",visible:v,onVisibleChange:function(e){g(e)},placement:"rightBottom"},r.a.createElement(j.a,{onClick:function(){return g(!0)}},E))))},Ct=v.a.Search,Pt=ze.a.Option,Nt=function(e){var t=e.onClose,n=e.onAdd,c=e.entity,i=Object(a.useState)([]),o=Object(u.a)(i,2),l=o[0],s=o[1],d=Object(g.b)(lt.TRANSLATE_WORD),f=Object(u.a)(d,1)[0],p=O.a.useForm(),b=Object(u.a)(p,1)[0],y=function(){var e=Object(h.a)(E.a.mark((function e(a){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(a),t();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(e){b.setFieldsValue({type:e})},w=function(){var e=Object(h.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==t){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,f({variables:{word:t,entity:c}});case 5:if(null!==(a=e.sent).data){e.next=8;break}return e.abrupt("return");case 8:r=a.data.translateWord,s(r.translate.map((function(e){return e.ru}))),b.setFieldsValue({translate:r.translate.map((function(e){return e.ru}))}),v(r.type);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement(O.a,{name:"basic",onFinish:y,form:b,size:"middle"},r.a.createElement(O.a.Item,{name:"en",rules:[{required:!0,message:"Please input your word!"}]},r.a.createElement(Ct,{onSearch:w,placeholder:"Word",enterButton:!0})),r.a.createElement(O.a.Item,{name:"translate",rules:[{required:!0,message:"Please input translate!"}]},r.a.createElement(ze.a,{mode:"tags",tokenSeparators:[","]},l.map((function(e){return r.a.createElement(Pt,{value:e},e)})))),r.a.createElement(m.a,null,r.a.createElement(O.a.Item,{name:"type",rules:[{required:!0,message:"Please select part of speech!"}],initialValue:ue.OTHER},r.a.createElement(Ke,{onChange:v})),r.a.createElement(O.a.Item,null,r.a.createElement(j.a,{size:"middle",type:"primary",htmlType:"submit",shape:"circle",icon:r.a.createElement(Me.a,null)}))))},Wt=de.a.Column,At=function(e){var t=Object(g.b)(lt.createOrUpdateWordWithTranslate),n=Object(u.a)(t,1)[0],c=Object(g.b)(lt.updateWordsByEntity),i=Object(u.a)(c,2),o=i[0],s=i[1].loading,d=Object(a.useRef)({}),f=Object(a.useRef)(new It),p=Object(g.a)(),b=Object(a.useState)(e.isCreate),y=Object(u.a)(b,2),O=y[0],v=y[1],w=Object(a.useState)(e.isCreate),S=Object(u.a)(w,2),I=S[0],x=S[1],T=Object(a.useState)(0),k=Object(u.a)(T,2),C=k[0],P=k[1],N=Object(a.useState)(e.words),W=Object(u.a)(N,2),A=W[0],D=W[1],U=Object(a.useState)(e.disconnectWords),$=Object(u.a)(U,2),R=$[0],_=$[1],H=function(e,t,n){return e.filter((function(e){return!(n?[]:t).some((function(t){return t.id===e.id}))})).map((function(e,a){var r=n?e.translate:e.translate.filter((function(t){return!e.disconnectTranslate.some((function(e){return e.id===t.id}))})),c=e.translate.filter((function(t){return!e.disconnectTranslate.some((function(e){return e.id===t.id}))})).length;return{key:e.id||a,en:e.en,type:e.type,isDelete:!!n&&t.some((function(t){return t.id===e.id})),children:r.map((function(t,a){return{key:t.id||a,ru:t.ru,type:t.type,count:c,idWord:e.id,isDelete:!!n&&e.disconnectTranslate.some((function(e){return e.id===t.id}))}}))}}))}(A,R,!!C),F={body:{row:vt,cell:jt}};Object(a.useEffect)((function(){f.current.addHandler({addDeleteWord:function(e){_((function(t){return[].concat(Object(Ve.a)(t),[{id:e}])}))},removeDeleteWord:function(e){_((function(t){return t.filter((function(t){return t.id!==e}))}))}}),f.current.addHandler({addDeleteTranslate:function(e){V(e)},removeDeleteTranslate:function(e){Z(e)}}),f.current.addHandler({actionForHandleChangeTypeNext:function(e){K(e)},actionForHandleChangeTypePrev:function(e){J(e)}}),f.current.addHandler({actionForHandleChangeInputValueNext:function(e){z(e)},actionForHandleChangeInputValuePrev:function(e){L(e)}})}),[]);var B=function(){var e=Object(h.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.children?(f.current.addAction({action:"addDeleteWord",payload:t.key}),_((function(e){return[].concat(Object(Ve.a)(e),[{id:t.key}])})),v(!1)):(f.current.addAction({action:"addDeleteTranslate",payload:{idTranslate:t.key,idWord:t.idWord}}),V({idTranslate:t.key,idWord:t.idWord}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){var t=e.idTranslate,n=e.idWord;D((function(e){var a=e.find((function(e){return e.id===n}));return a.disconnectTranslate=[].concat(Object(Ve.a)(a.disconnectTranslate),[{id:t}]),d.current[n]=a,Object(Ve.a)(e)}))},q=function(e){D((function(t){var n=t.findIndex((function(t){return t.id===(e.idWord||e.key)}));if(e.en){if(t[n].en===e.en)return t;f.current.addAction({action:"actionForHandleChangeInputValueNext",payload:{row:e,oldValue:t[n].en}}),t[n].en=e.en}else{var a=t[n].translate.findIndex((function(t){return t.id===e.key}));if(t[n].translate[a].ru===e.ru)return t;f.current.addAction({action:"actionForHandleChangeInputValueNext",payload:{row:e,oldValue:t[n].translate[a].ru}}),t[n].translate[a].ru=e.ru}return p.writeData({data:{step:2}}),d.current[e.idWord||e.key]=t[n],Object(Ve.a)(t)}))},z=function(e){G(e.row)},L=function(e){var t=Object(l.a)({},e.row);t.en=t.en?e.oldValue:"",t.ru=t.ru?e.oldValue:"",G(t)},G=function(e){D((function(t){var n=t.findIndex((function(t){return t.id===(e.idWord||e.key)}));if(e.en)t[n].en=e.en;else{var a=t[n].translate.findIndex((function(t){return t.id===e.key}));t[n].translate[a].ru=e.ru}return d.current[e.idWord||e.key]=t[n],Object(Ve.a)(t)}))},K=function(e){var t=e.id,n=e.idWord,a=e.type;M(a,t,n)},J=function(e){var t=e.id,n=e.idWord,a=e.oldType;M(a,t,n)},M=function(e,t,n){D((function(a){var r=a.findIndex((function(e){return e.id===(n||t)}));if(n){var c=a[r].translate.findIndex((function(e){return e.id===t}));a[r].translate[c].type=e}else a[r].type=e;return d.current[n||t]=a[r],Object(Ve.a)(a)}))},Y=function(){var t=Object(h.a)(E.a.mark((function t(a){var r,c;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p.writeData({data:{step:2}}),t.next=3,n({variables:{entityId:e.entityId,type:a.type,en:a.en,translate:a.translate}});case 3:r=t.sent,c=r.data.createOrUpdateWordWithTranslate,f.current.addAction({payload:c.id,action:"removeDeleteWord"}),D((function(e){return[].concat(Object(Ve.a)(e),[c])}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Q=function(e,t){var n=A.findIndex((function(t){return t.id===e}));-1===A[n].translate.findIndex((function(e){return e.id===t.id}))&&(A[n].translate.push(t),D(Object(Ve.a)(A)))},X=function(){o({variables:{data:{entityId:e.entityId,words:Object.values(d.current).map((function(e){return{type:e.type,id:e.id,disconnectTranslate:e.disconnectTranslate.map((function(e){return e.id})),translate:e.translate.map((function(e){return{id:e.id,type:e.type,ru:e.ru}}))}})),disconnectWords:R.map((function(e){return e.id}))}}}).then((function(e){d.current={},v(!0),x(!0),p.writeData({data:{step:3}})}))},Z=function(e){var t=e.idWord,n=e.idTranslate;D((function(e){var a=e.findIndex((function(e){return e.id===t}));return e[a].disconnectTranslate=e[a].disconnectTranslate.filter((function(e){return e.id!==n})),Object(Ve.a)(e)}))};return r.a.createElement(de.a,{bordered:!1,showHeader:!1,components:F,dataSource:H,pagination:!1,size:"small",rowClassName:function(){return"editable-row"},title:function(){return r.a.createElement(kt,{onAdd:Y,onUpdate:X,loadingUpdate:s,disabled:!!O&&qe(d.current),onChangeShowDeleted:P,disabledPrev:!f.current.isPrev(),disabledNext:!f.current.isNext(),onPrev:f.current.prev,onNext:f.current.next,entity:e.title,isCreate:I,addComponent:Nt,btnTitle:"Add word"})}},r.a.createElement(Wt,{title:"EN",dataIndex:"en",key:"en",width:"40%",onCell:function(e){return{record:e,dataIndex:"en",title:"EN",handleSave:q}}}),r.a.createElement(Wt,{title:"RU",dataIndex:"ru",key:"ru",width:"45%",onCell:function(e){return{record:e,editable:!0,dataIndex:"ru",title:"RU",handleSave:q}}}),r.a.createElement(Wt,{title:"Part of speech",dataIndex:"type",key:"type",width:"15%",render:function(e,t){return r.a.createElement(Ke,{value:e,onChange:function(e){return function(e,t,n){p.writeData({data:{step:2}}),D((function(a){var r=a.findIndex((function(e){return e.id===(n||t)}));if(n){var c=a[r].translate.findIndex((function(e){return e.id===t}));f.current.addAction({action:"actionForHandleChangeTypeNext",payload:{idWord:n,id:t,oldType:a[r].translate[c].type,type:e}}),a[r].translate[c].type=e}else f.current.addAction({action:"actionForHandleChangeTypeNext",payload:{idWord:n,id:t,oldType:a[r].type,type:e}}),a[r].type=e;return d.current[n||t]=a[r],Object(Ve.a)(a)}))}(e,t.key,t.idWord)}})}}),r.a.createElement(Wt,{title:"Operation",dataIndex:"operation",render:function(e,t){var n=!t.idWord,a=n?t.key:t.idWord,c=n?void 0:t.key;return t.isDelete?r.a.createElement(j.a,{size:"small",shape:"circle-outline",icon:r.a.createElement(gt.a,null),onClick:function(){return function(e){var t=e.idTranslate,n=e.idWord;t?(f.current.addAction({action:"removeDeleteTranslate",payload:{idTranslate:t,idWord:n}}),Z({idTranslate:t,idWord:n})):(f.current.addAction({action:"removeDeleteWord",payload:n}),_((function(e){return e.filter((function(e){return e.id!==n}))})),v(!1))}({idWord:a,idTranslate:c})}}):t.count&&1===t.count?null:r.a.createElement(m.a,{align:"middle"},n&&r.a.createElement(mt,{idWord:t.key,onAdd:Q}),r.a.createElement(j.a,{danger:!0,size:"small",shape:"circle",icon:r.a.createElement(wt.a,null),onClick:function(){return B(Object(l.a)({},t))}}))}}))},Dt=v.a.Search,Ut=function(e){var t=e.onClose,n=e.onAdd,a=e.entity,c=Object(g.b)(lt.translatePhrase),i=Object(u.a)(c,2),o=i[0],l=i[1].loading,s=O.a.useForm(),d=Object(u.a)(s,1)[0],f=function(){var e=Object(h.a)(E.a.mark((function e(a){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(a),t();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(h.a)(E.a.mark((function e(t,n){var r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,o({variables:{phrase:t,entity:a}});case 3:if(null!==(r=e.sent).data){e.next=6;break}return e.abrupt("return");case 6:c=r.data.translatePhrase,d.setFieldsValue({ru:c.ru});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement(O.a,{name:"basic",onFinish:f,form:d},r.a.createElement(O.a.Item,{name:"phrase",rules:[{required:!0,message:"Please input your phrase!"}]},r.a.createElement(Dt,{onSearch:p,placeholder:"Phrase",enterButton:!0,loading:l})),r.a.createElement(v.a.Group,{compact:!0,size:"default"},r.a.createElement(O.a.Item,{name:"ru",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(v.a,null)),r.a.createElement(O.a.Item,null,r.a.createElement(j.a,{type:"primary",htmlType:"submit",icon:r.a.createElement(Me.a,null)}))))},$t=de.a.Column,Rt=function(e){var t=Object(g.b)(lt.translatePhrase),n=Object(u.a)(t,1)[0],c=Object(g.b)(lt.upsertPhrase),i=Object(u.a)(c,1)[0],o=Object(g.b)(lt.updatePhraseByEntity),s=Object(u.a)(o,2),d=s[0],f=s[1].loading,p=Object(a.useState)(e.phrases),m=Object(u.a)(p,2),b=m[0],y=m[1],O=Object(a.useState)(e.disconnectPhrases),v=Object(u.a)(O,2),w=v[0],S=v[1],I=Object(a.useState)(e.isCreate),x=Object(u.a)(I,2),T=x[0],k=x[1],C=Object(a.useState)(e.isCreate),P=Object(u.a)(C,2),N=P[0],W=P[1],A=Object(g.a)(),D=Object(a.useState)(0),U=Object(u.a)(D,2),$=U[0],R=U[1],_=Object(a.useRef)({}),H=Object(a.useRef)(new It),F={body:{row:vt,cell:jt}};Object(a.useEffect)((function(){H.current.addHandler({deletePhrase:function(e){S((function(t){return[].concat(Object(Ve.a)(t),[{id:e}])}))},recoverPhrase:function(e){S((function(t){return t.filter((function(t){return t.id!==e}))}))}}),H.current.addHandler({actionForHandleSaveNext:function(e){V(e)},actionForHandleSavePrev:function(e){q(e)}})}),[]);var B=function(){var e=Object(h.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.findIndex((function(e){return e.id===t.id})),b[n].phrase!==t.phrase||b[n].ru!==t.ru){e.next=3;break}return e.abrupt("return");case 3:A.writeData({data:{step:2}}),_.current[t.id]=t,H.current.addAction({payload:{oldValue:Object(l.a)({},b[n]),newValue:Object(l.a)({},t)},action:"actionForHandleSaveNext"}),t.isNeededTranslate=!t.isNeededTranslate,b[n]=t,y((function(e){return Object(Ve.a)(e)}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){z(e.newValue)},q=function(e){z(e.oldValue)},z=function(){var e=Object(h.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y((function(e){_.current[t.id]=t;var n=e.findIndex((function(e){return e.id===t.id}));return e[n]=t,Object(Ve.a)(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){d({variables:{data:{entityId:e.entityId,disconnectPhrases:w.map((function(e){return e.id})),phrases:Object.values(_.current).map((function(e){return{id:e.id,ru:e.ru,phrase:e.phrase}}))}}}).then((function(){_.current={},k(!0),W(!0),A.writeData({data:{step:3}})}))},G=function(){var t=Object(h.a)(E.a.mark((function t(n){var a,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A.writeData({data:{step:2}}),t.next=3,i({variables:{phrase:n.phrase,ru:n.ru,entityId:e.entityId}});case 3:a=t.sent,r=a.data.upsertPhrase,y((function(e){return[].concat(Object(Ve.a)(e),[r])}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),K=function(){var t=Object(h.a)(E.a.mark((function t(a){var r,c,i;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({variables:{phrase:a.phrase,entity:e.title}});case 2:if(null!==(r=t.sent).data){t.next=9;break}return c=b.findIndex((function(e){return e.id===a.id})),a.isNeededTranslate=!1,b[c]=a,y((function(e){return Object(Ve.a)(e)})),t.abrupt("return");case 9:return i=r.data.translatePhrase,a.ru=i.ru,t.next=13,B(a);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=$?b:b.filter((function(e){return!w.some((function(t){return t.id===e.id}))}));return r.a.createElement(de.a,{bordered:!1,showHeader:!1,components:F,dataSource:J,pagination:!1,size:"small",rowClassName:function(){return"editable-row"},title:function(){return r.a.createElement(kt,{onAdd:G,onUpdate:L,loadingUpdate:f,disabled:!!T&&qe(_.current),entity:e.title,isCreate:N,onNext:H.current.next,onPrev:H.current.prev,disabledPrev:!H.current.isPrev(),disabledNext:!H.current.isNext(),onChangeShowDeleted:R,addComponent:Ut,btnTitle:"Add phrase"})}},r.a.createElement($t,{title:"Phrase",dataIndex:"phrase",key:"phrase",width:"40%",onCell:function(e){return{record:e,editable:!0,extra:!0,dataIndex:"phrase",title:"Phrase",handleSave:B,handleTranslate:K}}}),r.a.createElement($t,{title:"RU",dataIndex:"ru",key:"ru",width:"45%",onCell:function(e){return{record:e,editable:!0,dataIndex:"ru",title:"RU",handleSave:B}}}),r.a.createElement($t,{title:"Operation",dataIndex:"operation",render:function(e,t){return w.some((function(e){return e.id===t.id}))?r.a.createElement(j.a,{size:"small",shape:"circle-outline",icon:r.a.createElement(gt.a,null),onClick:function(){return e=t.id,S((function(t){return t.filter((function(t){return t.id!==e}))})),H.current.addAction({action:"recoverPhrase",payload:e}),void k(!1);var e}}):r.a.createElement(j.a,{danger:!0,size:"small",shape:"circle",icon:r.a.createElement(wt.a,null),onClick:function(){return e=Object(l.a)({},t),S((function(t){return[].concat(Object(Ve.a)(t),[{id:e.id}])})),H.current.addAction({action:"deletePhrase",payload:e.id}),void k(!1);var e}})}}))},_t=n(511),Ht=v.a.Search,Ft=function(e){var t=e.onClose,n=e.onAdd,a=e.entity,c=Object(g.b)(lt.translateSentence),i=Object(u.a)(c,2),o=i[0],l=i[1].loading,s=O.a.useForm(),d=Object(u.a)(s,1)[0],f=function(){var e=Object(h.a)(E.a.mark((function e(a){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(a),t();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(h.a)(E.a.mark((function e(t,n){var r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,o({variables:{sentence:t,entity:a}});case 3:if(null!==(r=e.sent).data){e.next=6;break}return e.abrupt("return");case 6:c=r.data.translateSentence,d.setFieldsValue({ru:c.ru});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement(O.a,{name:"basic",onFinish:f,form:d},r.a.createElement(O.a.Item,{name:"sentence",rules:[{required:!0,message:"Please input your sentence!"}]},r.a.createElement(Ht,{onSearch:p,placeholder:"Sentence",enterButton:!0,loading:l})),r.a.createElement(v.a.Group,{compact:!0,size:"default"},r.a.createElement(O.a.Item,{name:"ru",rules:[{required:!0,message:"Please input your sentence!"}]},r.a.createElement(v.a,null)),r.a.createElement(O.a.Item,null,r.a.createElement(j.a,{type:"primary",htmlType:"submit",icon:r.a.createElement(Me.a,null)}))))},Bt=de.a.Column,Vt=function(e){var t=Object(g.b)(lt.translateSentence),n=Object(u.a)(t,1)[0],c=Object(g.b)(lt.upsertSentence),i=Object(u.a)(c,1)[0],o=Object(g.b)(lt.updateSentencesByEntity),s=Object(u.a)(o,2),d=s[0],f=s[1].loading,p=Object(a.useState)(e.sentences),m=Object(u.a)(p,2),b=m[0],y=m[1],O=Object(a.useState)(e.disconnectSentences),v=Object(u.a)(O,2),w=v[0],S=v[1],I=Object(a.useState)(e.isCreate),x=Object(u.a)(I,2),T=x[0],k=x[1],C=Object(a.useState)(e.isCreate),P=Object(u.a)(C,2),N=P[0],W=P[1],A=Object(g.a)(),D=Object(a.useState)(0),U=Object(u.a)(D,2),$=U[0],R=U[1],_=Object(a.useRef)({}),H=Object(a.useRef)(new It),F={body:{row:vt,cell:jt}};Object(a.useEffect)((function(){H.current.addHandler({deleteSentence:function(e){S((function(t){return[].concat(Object(Ve.a)(t),[{id:e}])}))},recoverSentence:function(e){S((function(t){return t.filter((function(t){return t.id!==e}))}))}}),H.current.addHandler({actionForHandleSaveNext:function(e){V(e)},actionForHandleSavePrev:function(e){q(e)}})}),[]);var B=function(){var e=Object(h.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.findIndex((function(e){return e.id===t.id})),b[n].sentence!==t.sentence||b[n].ru!==t.ru){e.next=3;break}return e.abrupt("return");case 3:A.writeData({data:{step:2}}),_.current[t.id]=t,H.current.addAction({payload:{oldValue:Object(l.a)({},b[n]),newValue:Object(l.a)({},t)},action:"actionForHandleSaveNext"}),t.isNeededTranslate=!t.isNeededTranslate,b[n]=t,y((function(e){return Object(Ve.a)(e)}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){z(e.newValue)},q=function(e){z(e.oldValue)},z=function(){var e=Object(h.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y((function(e){_.current[t.id]=t;var n=e.findIndex((function(e){return e.id===t.id}));return e[n]=t,Object(Ve.a)(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){d({variables:{data:{entityId:e.entityId,disconnectSentences:w.map((function(e){return e.id})),sentences:Object.values(_.current).map((function(e){return{id:e.id,ru:e.ru,sentence:e.sentence}}))}}}).then((function(){_.current={},k(!0),W(!0),A.writeData({data:{step:3}})}))},G=function(){var t=Object(h.a)(E.a.mark((function t(n){var a,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A.writeData({data:{step:2}}),t.next=3,i({variables:{sentence:n.sentence,ru:n.ru,entityId:e.entityId}});case 3:a=t.sent,r=a.data.upsertSentence,y((function(e){return[].concat(Object(Ve.a)(e),[r])}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),K=function(){var t=Object(h.a)(E.a.mark((function t(a){var r,c,i;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({variables:{sentence:a.sentence,entity:e.title}});case 2:if(null!==(r=t.sent).data){t.next=9;break}return c=b.findIndex((function(e){return e.id===a.id})),a.isNeededTranslate=!1,b[c]=a,y((function(e){return Object(Ve.a)(e)})),t.abrupt("return");case 9:return i=r.data.translateSentence,a.ru=i.ru,t.next=13,B(a);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=$?b:b.filter((function(e){return!w.some((function(t){return t.id===e.id}))}));return r.a.createElement(de.a,{bordered:!1,showHeader:!1,components:F,dataSource:J,pagination:!1,size:"small",rowClassName:function(){return"editable-row"},title:function(){return r.a.createElement(kt,{onAdd:G,onUpdate:L,loadingUpdate:f,disabled:!!T&&qe(_.current),entity:e.title,isCreate:N,onNext:H.current.next,onPrev:H.current.prev,disabledPrev:!H.current.isPrev(),disabledNext:!H.current.isNext(),onChangeShowDeleted:R,addComponent:Ft,btnTitle:"Add sentence"})}},r.a.createElement(Bt,{title:"Sentence",dataIndex:"sentence",key:"sentence",width:"40%",onCell:function(e){return{record:e,editable:!0,extra:!0,dataIndex:"sentence",title:"Sentence",handleSave:B,handleTranslate:K}}}),r.a.createElement(Bt,{title:"RU",dataIndex:"ru",key:"ru",width:"45%",onCell:function(e){return{record:e,editable:!0,dataIndex:"ru",title:"RU",handleSave:B}}}),r.a.createElement(Bt,{title:"Operation",dataIndex:"operation",render:function(e,t){return w.some((function(e){return e.id===t.id}))?r.a.createElement(j.a,{size:"small",shape:"circle-outline",icon:r.a.createElement(gt.a,null),onClick:function(){return e=t.id,S((function(t){return t.filter((function(t){return t.id!==e}))})),H.current.addAction({action:"recoverSentence",payload:e}),void k(!1);var e}}):r.a.createElement(j.a,{danger:!0,size:"small",shape:"circle",icon:r.a.createElement(wt.a,null),onClick:function(){return e=Object(l.a)({},t),S((function(t){return[].concat(Object(Ve.a)(t),[{id:e.id}])})),H.current.addAction({action:"deleteSentence",payload:e.id}),void k(!1);var e}})}}))},qt=Be.a.Panel,zt=function(e){var t=e.entity;return r.a.createElement(Be.a,{bordered:!1,defaultActiveKey:["1"],expandIcon:function(e){var t=e.isActive;return r.a.createElement(_t.a,{rotate:t?-90:0})},className:"site-collapse-custom-collapse",expandIconPosition:"right"},r.a.createElement(qt,{header:"Words",key:"1",className:"site-collapse-custom-panel"},r.a.createElement(At,{words:t.words,disconnectWords:t.disconnectWords,entityId:t.id,title:t.title,isCreate:t.isCreate})),r.a.createElement(qt,{header:"Phrases",key:"2",className:"site-collapse-custom-panel"},r.a.createElement(Rt,{phrases:t.phrases,disconnectPhrases:t.disconnectPhrases,entityId:t.id,title:t.title,isCreate:t.isCreate})),r.a.createElement(qt,{header:"Sentences",key:"3",className:"site-collapse-custom-panel"},r.a.createElement(Vt,{sentences:t.sentences,disconnectSentences:t.disconnectSentences,entityId:t.id,title:t.title,isCreate:t.isCreate})))},Lt=n(512),Gt=n(513),Kt=n(514),Jt=n(515),Mt=v.a.Search,Yt=Fe.a.Step,Qt=function(e){var t=Object(a.useState)([]),n=Object(u.a)(t,2),c=n[0],i=n[1],o=Object(g.b)(lt.GET_ENTITIES_BY_WORD),l=Object(u.a)(o,1)[0],s=Object(g.c)(V.getEntity,{skip:!e.location.state,variables:{id:e.location.state&&e.location.state.id},onCompleted:function(e){console.log(e),e&&i([e.getEntity])}});Object(He.a)(s);var d=Object(g.a)(),f=Object(g.c)(V.GET_STEP_CLIENT).data,p=Object(g.c)(V.GET_COUNT_ENTITIES).data,y=Object(a.useState)(p?p.getCountEntities:1),O=Object(u.a)(y,2),v=O[0],j=O[1],w=function(){var e=Object(h.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({variables:{word:t.toLowerCase()}});case 2:(n=e.sent).data&&(i(n.data.getEntitiesByWord),d.writeData({data:{step:1}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){d.writeData({data:{step:0}})}),[]),Object(a.useEffect)((function(){3===f.step&&setTimeout((function(){j(5)}),2e3)}),[f.step]);var S=!(c.length>0)||!c[0].isCreate;return r.a.createElement(m.a,null,r.a.createElement(b.a,{span:24},r.a.createElement(ye.a,{size:"small"},S&&v<=3&&r.a.createElement(Fe.a,{current:f.step},r.a.createElement(Yt,{icon:r.a.createElement(Lt.a,null),title:"First word",description:"Input word for search"}),r.a.createElement(Yt,{icon:r.a.createElement(Gt.a,null),title:"Update",description:"Do changes"}),r.a.createElement(Yt,{icon:r.a.createElement(Kt.a,null),title:"Save",description:"Click on button by 'Create'"}),r.a.createElement(Yt,{icon:r.a.createElement(Jt.a,null),title:"Keanu Reeves said: ",description:"You are amazing!"})),r.a.createElement(Mt,{placeholder:"Input text for create entity of word",enterButton:"Search",size:"large",onSearch:w}))),c.map((function(e,t){return r.a.createElement(b.a,{flex:"1",key:e.id||t},r.a.createElement(zt,{entity:e}))})))},Xt=ee.a.Content,Zt=ee.a.Sider,en=ie((function(e){var t=e.match.params.item||"words",n=Object(g.a)(),c=Object(d.g)(),i=oe(),o=i.isAdmin,l=i.user,s=Object(a.useState)(!1),f=Object(u.a)(s,2),p=f[0],m=f[1],b=function(){var e=Object(h.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.cache.reset();case 2:localStorage.removeItem("token"),c.replace("/");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(ee.a,{style:{minHeight:"100vh"}},r.a.createElement(Zt,{collapsible:!0,collapsed:p,onCollapse:function(e){m(e)},theme:"light"},r.a.createElement("div",{className:Y.a.profile},l&&"".concat(l.name," ").concat(l.lastName)),r.a.createElement(te.a,{theme:"light",selectedKeys:[t],mode:"inline"},r.a.createElement(te.a.Item,{key:"create",icon:r.a.createElement(ne.a,null),onClick:function(){return e.history.push("/main/create")}},"Create"),r.a.createElement(te.a.Item,{key:"words",icon:r.a.createElement(ae.a,null),onClick:function(){return e.history.push("/main/words")}},"Words"),o&&r.a.createElement(te.a.Item,{key:"users",icon:r.a.createElement(re.a,null),onClick:function(){return e.history.push("/main/users")}},"Users"),r.a.createElement(te.a.Item,{key:"exit",icon:r.a.createElement(ce.a,null),onClick:b},"Exit"))),r.a.createElement(ee.a,{className:"site-layout"},r.a.createElement(Xt,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/main/users",component:be}),r.a.createElement(d.b,{path:"/main/words",component:$e}),r.a.createElement(d.b,{path:"/main/create",component:Qt}),r.a.createElement(d.b,{component:_e})))))})),tn=n(52),nn=n(91),an=n(154),rn=n(240),cn=n(105),un=n(277),on=n(75);function ln(){var e=Object(o.a)(["\n              fragment entity on Entity {\n                  ","\n              }\n          "]);return ln=function(){return e},e}console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/dictionary",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}));var sn=Object(un.a)((function(e){var t=e.graphQLErrors,n=void 0===t?[]:t,a=e.networkError,r=e.operation,c=e.forward,i=e.response;console.log({graphQLErrors:n,networkError:a,operation:r,forward:c,response:i}),console.log("production"),n.map((function(e){s.a.error({message:e.message})}))})),dn=new an.a((function(e,t){return e.setContext((function(e){var t=e.headers;return{headers:Object(l.a)({authorization:"Bearer ".concat(localStorage.getItem("token"))},t)}})),t(e)})),fn=new cn.a({uri:"https://englishnew.herokuapp.com/graphql"}),pn=new nn.a,mn=new on.a({cache:pn,link:Object(rn.a)([dn,sn,fn]),connectToDevTools:!0,defaultOptions:{mutate:{errorPolicy:"ignore"},query:{errorPolicy:"ignore"}},resolvers:{Query:{getEntity:function(e,t,n){var a=t.id,r=n.cache,c=n.getCacheKey;return r.readFragment({id:c({__typename:"Entity",id:a}),fragment:Object(w.a)(ln(),S.entity)})}}}});pn.writeData({data:{isAuth:!1,currentUser:null,step:0}});var bn=function(){var e=function(){var e=Object(g.b)(V.REFRESH_USER,{update:function(e,t){e.writeData({data:{isAuth:!0,currentUser:t.data.refreshUser}})}}),t=Object(u.a)(e,1)[0];return Object(a.useEffect)((function(){t()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:Z}),r.a.createElement(d.b,{path:"/main/:item?",component:en})))};return r.a.createElement(tn.a,{client:mn},r.a.createElement(f.a,{basename:"/dictionary"},r.a.createElement(e,null)))};n(489),n(490);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(bn,null)),document.getElementById("root"))}},[[299,1,2]]]);
//# sourceMappingURL=main.85031043.chunk.js.map